# MathOCR フロントエンド

数学問題のOCR・LaTeX編集・解説生成を行うWebアプリのフロントエンドです。Next.js（App Router）で構築し、バックエンドAPIとセッション認証で連携します。

## 技術スタック

- **Next.js 16**（App Router）
- **React 19**
- **TypeScript**
- **Tailwind CSS**
- **OpenAPI 型生成**（`generate:api` でバックエンドスキーマから型を生成）

## セットアップ

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 環境変数の設定（オプション）

バックエンドAPIのURLを変更する場合のみ `.env` を用意します。

```bash
cp .env.example .env
```

デフォルトでは `http://localhost:8000` を使用します。

### 3. API型の生成（オプション）

バックエンドの開発サーバーが起動している状態で、OpenAPI から型を生成できます。

```bash
npm run generate:api
```

### 4. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで http://localhost:3000 にアクセスしてください。

## 主な機能

### ログイン (`/login`)

- ユーザー名とパスワードでログイン
- セッション認証（Cookie）を使用
- ログイン後、自動的に **`/project`（プロジェクト一覧）** にリダイレクト

### プロジェクト一覧・作成 (`/project`)

- プロジェクトの一覧表示・検索・ソート
- 新規プロジェクトの作成
- カードクリックでエディタ画面へ遷移

### エディタ (`/project/[id]/editor`)

- **OCR**: 画像アップロードでLaTeXコードを生成
- **LaTeX編集**: 問題文・解説のLaTeXを編集
- **PDFプレビュー**: 編集内容をPDFで表示
- **解説生成**: AIによる解説の自動生成
- テンプレートの選択・切り替え

### テンプレート管理 (`/template`)

- LaTeX文書テンプレートの一覧・作成・編集・削除

### ゴミ箱 (`/trash`)

- 削除したプロジェクトの一覧と復元

## バックエンドとの連携

本フロントエンドは、同リポジトリの **バックエンド（Django REST Framework）** と組み合わせて動作します。認証APIはバックエンドに実装済みです。

### 使用する主なエンドポイント

| 用途       | メソッド | URL                  |
|------------|----------|----------------------|
| ログイン   | POST     | `/api/auth/login/`   |
| ログアウト | POST     | `/api/auth/logout/`  |
| 現在のユーザー | GET  | `/api/auth/user/`    |
| CSRFトークン | GET   | `/api/csrf/`（レスポンス: `{ "token": "..." }`） |

認証はセッションCookieで行い、変更・削除系のリクエストではCSRFトークンをヘッダー `X-CSRFToken` に付与しています。

## 認証の流れ

1. ログイン時にユーザー名・パスワードを `POST /api/auth/login/` に送信
2. バックエンドがセッションCookieを設定
3. 以降のAPIリクエストではCookieが自動送信され、必要に応じてCSRFトークンをヘッダーに追加
